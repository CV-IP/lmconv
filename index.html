<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<link rel="stylesheet" href="resources/styles.css">
<link href='https://fonts.googleapis.com/css?family=Titillium+Web:400,600,400italic,600italic,300,300italic' rel='stylesheet' type='text/css'>
<head>
<div max-width=100%>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link rel="icon" type="image/png" href="favicon.ico">
  <title>Locally Masked Convolution for Autoregressive Models</title>
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="canonical" href="https://ajayjain.github.io/lmconv/" />
  <meta name="referrer" content="no-referrer-when-downgrade" />

  <meta property="og:site_name" content="Locally Masked Convolution" />
  <meta property="og:type" content="video.other" />
  <meta property="og:title" content="Locally Masked Convolution for Autoregressive Models" />
  <meta property="og:description" content="Jain, Abbeel, Pathak. Locally Masked Convolution for Autoregressive Models. UAI 2020." />
  <meta property="og:url" content="https://ajayjain.github.io/lmconv/" />
  <meta property="og:image" content="https://ajayjain.github.io/lmconv/resources/lmconv_overview_2to1.png" />

  <meta property="article:publisher" content="https://github.com/ajayjain" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Locally Masked Convolution for Autoregressive Models" />
  <meta name="twitter:description" content="Jain, Abbeel, Pathak. Locally Masked Convolution for Autoregressive Models. UAI 2020." />
  <meta name="twitter:url" content="https://ajayjain.github.io/lmconv/" />
  <meta name="twitter:image" content="https://ajayjain.github.io/lmconv/resources/lmconv_overview_2to1.png" />
  <meta name="twitter:site" content="@ajayjain" />
  <meta property="og:image:width" content="1600" />
  <meta property="og:image:height" content="900" />
</head>

<body>
      <br>
      <center><span style="font-size:44px;font-weight:bold;">Locally Masked Convolution for Autoregressive Models</span></center><br/>
      <div class="table-like" style="justify-content:space-evenly;max-width:900px;margin:auto;">
          <div><center><span style="font-size:18px"><a href="https://ajayjain.net/" target="_blank">Ajay Jain</a></span></center>
          <center><span style="font-size:18px">UC Berkeley</span></center>
          </div>

          <div><center><span style="font-size:18px"><a href="https://people.eecs.berkeley.edu/~pabbeel/" target="_blank">Pieter Abbeel</a></span></center>
          <center><span style="font-size:18px">UC Berkeley</span></center>
          </div>

          <div><center><span style="font-size:18px"><a href="https://people.eecs.berkeley.edu/~pathak/" target="_blank">Deepak Pathak</a></span></center>
          <center><span style="font-size:18px">CMU</span></center>
          </div>
      </div>
      <center><span style="font-size:20px;"><a href='http://www.auai.org/uai2020/'>Conference on Uncertainty in AI (UAI), 2020</a></span></center>

      <div class="table-like" style="justify-content:space-evenly;max-width:700px;margin:auto;padding:5px">
        <div><center><span style="font-size:28px"><a href='https://arxiv.org/pdf/2006.12486.pdf'>[Paper]</a></span></center></div>
        <div><center><span style="font-size:28px"><a href='https://github.com/ajayjain/lmconv'>[GitHub Code]</a></span></center> </div>
      </div>

      <div style="width:800px; margin:0 auto; text-align=right;">
      <p>
      <b>Summary:</b> Our Locally Masked PixelCNN generates natural images in customizable orders like zig-zags and Hilbert Curves.
      We train a single PixelCNN++ to support 8 generation orders simultaneously, outperforming PixelCNN++ on distribution estimation
      and allowing globally coherent image completions on CIFAR10, CelebA-HQ and MNIST.
      We control the order with our proposed locally masked convolution operation, which is efficient and easy to implement via matrix multiplication.
    </p>
      <a href="resources/lmconv_overview.png"><img width="768" max-width="100%" src="resources/lmconv_overview.png" /></a>
      <p>
        <b>Abstract:</b> There is substantial interest in modeling high dimensional data distributions such as images, with applications including compression, multimedia generation, anomaly detection, and data completion.
        State-of-the-art density estimators for natural images are autoregressive, decomposing the joint distribution over pixels into a product of conditionals.
        The conditional distributions are parameterized by an expressive deep neural network, <em>e.g.</em> a convolutional neural network such as the PixelCNN.
        However, convolutional autoregressive models can only model a single decomposition of the joint where only a single generation order is efficient.
        For tasks such as missing data completion, these models are unable to use much of the observed context.
        To generate data in arbitrary orders, we introduce LMConv: a simple modification to the standard 2D convolution that allows arbitrary masks to be applied to the weights at each location in the image.
        Using LMConv, we learn an ensemble of density estimators that share parameters but differ in generation order, achieving improved performance on whole-image density estimation as well as globally coherent image completions.
      </p>
      </div>
      <center>
      <br><hr>

      <center><h1>Locally Masked Convolution</h1></center>
      <div style="width:800px; margin:0 auto; text-align: left">
        Autoregressive models generate images one pixel at a time, but are typically trained with a single generation order.
      We train a PixelCNN that can decompose the joint distribution over image dimensions with arbitrary autoregressive orderings.
      At test time, we evaluate more accurate likelihoods by ensembling across multiple orders (shared parameters),
      or complete missing image dimension by choosing a favorable order.
      To implement these models on images, we propose locally masked convolutions that <b>efficiently apply different masks to the input image at each conv filter location</b>,
      allowing full control over the order.
      </div>
      <br />
      <center><a href="resources/completion.png"><img src = "resources/completion.png" width="600px" ></img></a><br></center>
      <center><a href="resources/teaser_color.png"><img src = "resources/teaser_color.png" width="800px" ></img></a><br></center>
      <hr>

      <center><h1>Customized Order along Hilbert Curve</h1></center>
      <div style="width:800px; margin:0 auto 10px auto; text-align: left">
        Since Locally Masked PixelCNN can support arbitrary orders, we trained it to generate binary MNIST digits along Hilbert space-filling curves.
        With this order, consecutively generated pixels lie in the same neighborhood of the image agnostic to its resolution.
      </div>
      <center>
      <video width="400" height="400" controls autoplay loop>
        <source src="resources/lmconv_hilbert.mp4" type="video/mp4">
        <!-- <source src="movie.ogg" type="video/ogg"> -->
      Your browser does not support the video tag.
      </video>
      </center>
      <br />
      <hr>

      <div style="width:800px; margin:0 auto; text-align=center">
        <center><h1>Overview of the Algorithm</h1></center>
      </div>
      <div style="width:800px; margin:0 auto; text-align: left">
        Locally masked convolutions mask features patches, not CNN filter weights.
        This can be efficiently implemented with the im2col algorithm, which computes convolutions with matrix multiplication.
      </div>
      <br/>
          <center><a href="resources/im2col.png"><img src = "resources/im2col.png" width="800px"></img></a><br></center>
      <br/><hr>


            <center id="sourceCode"><h1>Source Code</h1></center>
            <div style="width:800px; margin:0 auto; text-align: left">
                PyTorch code for our paper is open-source and available on GitHub. We include a memory-efficient, pure Python implementation of the locally masked convolution, as well as training and evaluation code.
            </div>
            <table align=center width=300px>
              <tr>
                <td width=300px align=center>
                  <span style="font-size:28px"><a href='https://github.com/ajayjain/lmconv'>[GitHub]</a></span>
                </td>
              </tr>
            </table>
            <br><hr>

            <table align=center width=700px style="max-width: 100%">
              <center><h1>Paper and Bibtex</h1></center>
              <tr>
              <td width=250px align=left>
              <!-- <p style="margin-top:4px;"></p> -->
              <a href="https://arxiv.org/pdf/2006.12486.pdf" target="_blank"><img style="height:150px" src="resources/thumbnail.png"/></a>
              <center>
              <span style="font-size:20pt"><a href="https://arxiv.org/pdf/2006.12486.pdf" target="_blank">[Paper]</a></span>
              </center>
              </td>
              <td width=20px align=center>
              </td>
              <td width=250px align=left>
              <p style="text-align:left;">
                <b><span style="font-size:20pt">Citation</span></b>
                <br/>
                <span style="font-size:6px;">&nbsp;<br/></span> <span style="font-size:15pt">Ajay Jain, Pieter Abbeel, Deepak Pathak. <b>Locally Masked Convolution for Autoregressive Models.</b> In <em>Conference on Uncertainty in Artificial Intelligence (UAI)</em>, 2020.</span></p>
              </td>
              </tr>
              <tr>
              <td width=250px align=left>
              </td>
              <td width=50px align=center>
              </td>
              <td width=550px align=left>
                <div class="paper" id="lmconv2020_bib">
<pre xml:space="preserve">
@inproceedings{jain2020lmconv,
    title={Locally Masked Convolution
    for Autoregressive Models},
    author={Ajay Jain and Pieter
    Abbeel and Deepak Pathak},
    year={2020},
    booktitle={Conference on Uncertainty
    in Artificial Intelligence (UAI)},
}</pre>
                </div>
                </td>
                </tr>
            </table>
          <hr>


      <div style="text-align:right; font-size: 10px;">
        <a href="https://ramanans1.github.io/plan2explore/" style="color: #ccc">Website source</a>
      </div>
      </table>
</div>
</body>
</html>
